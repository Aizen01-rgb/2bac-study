<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Admin | 2BAC</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#0b1020;color:#fff}
.container{padding:20px}
.card{background:#111936;padding:20px;border-radius:16px;margin-bottom:20px}
input,select,button{width:100%;padding:10px;margin:6px 0;border-radius:10px;border:none}
button{background:#7c3aed;color:white;font-weight:bold;cursor:pointer}
.danger{background:#ef4444}
.item{background:#1a244a;padding:10px;border-radius:10px;margin-top:8px}
.row{display:flex;justify-content:space-between;gap:6px}
</style>
</head>

<body>
<div class="container">

<div class="card">
<h3>ðŸ‘¤ Users</h3>
<input id="userEmail" placeholder="user@gmail.com">
<button onclick="addUser()">Add User</button>
<div id="usersList"></div>
</div>

<div class="card">
<h3>ðŸ”‘ Codes</h3>
<select id="codeUser"></select>
<input id="manualCode" placeholder="Manual Code">
<button onclick="addManualCode()">Add Manual Code</button>
<button onclick="generateCode()">Generate Code</button>
</div>

</div>

<script>
let users = JSON.parse(localStorage.getItem("users")) || [];
let codes = JSON.parse(localStorage.getItem("codes")) || {};

function save(){
  localStorage.setItem("users",JSON.stringify(users));
  localStorage.setItem("codes",JSON.stringify(codes));
  render();
}

function addUser(){
  const e=userEmail.value.trim();
  if(!e||users.includes(e))return;
  users.push(e);
  save();
  userEmail.value="";
}

function generateCode(){
  const u=codeUser.value;
  if(!u)return;
  codes[u]="CODE-"+Math.random().toString(36).substr(2,6).toUpperCase();
  save();
}

function addManualCode(){
  const u=codeUser.value;
  if(!u||!manualCode.value)return;
  codes[u]=manualCode.value;
  manualCode.value="";
  save();
}

function deleteUser(u){
  users=users.filter(x=>x!==u);
  delete codes[u];
  save();
}

function deleteCode(u){
  delete codes[u];
  save();
}

function render(){
  usersList.innerHTML="";
  codeUser.innerHTML='<option value="">-- choose user --</option>';
  users.forEach(u=>{
    codeUser.innerHTML+=`<option value="${u}">${u}</option>`;
    usersList.innerHTML+=`
      <div class="item">
        <div>${u}</div>
        <div>${codes[u]||"NO CODE"}</div>
        <div class="row">
          <button class="danger" onclick="deleteUser('${u}')">Delete User</button>
          ${codes[u]?`<button class="danger" onclick="deleteCode('${u}')">Delete Code</button>`:""}
        </div>
      </div>`;
  });
}

render();
</script>
</body>
</html>